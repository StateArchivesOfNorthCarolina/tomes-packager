<mets xmlns="http://www.loc.gov/METS/" 
xmlns:xlink="http://www.w3.org/1999/xlink" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <!--# !!! WARNING !!!
  DO NOT edit this template unless you are very comfortable with Python, Jinja templates, and METS.
  AND if you know how the TOMES Packager's lib.DirectoryObject module works.
  #-->
  <metsHdr CREATEDATE="{{ TIMESTAMP() }}">
    <agent ROLE="CREATOR" TYPE="OTHER" OTHERTYPE="Software Agent">
      <name>TOMES Packager</name>
    </agent>
  </metsHdr>
  <fileSec ID="fileSec">
    <fileGrp ID="fileGrp_">
    %% for file in FILES() %%
	  %% if ".mets.manifest" not in file.basename %%
      <file SIZE="{{ file.size }}" ID="_{{ file.index }}" MIMETYPE="{{ file.mimetype() }}" CREATED="{{ file.created }}" CHECKSUM="{{ file.checksum() }}" CHECKSUMTYPE="{{ file.checksum_algorithm }}">
        <FLocat xlink:href="{{ file.name }}" LOCTYPE="OTHER" OTHERLOCTYPE="SYSTEM" />
    </file>
      %% endif %%
    %% endfor %%
    </fileGrp>
	%% set skipped = [] %%
    %% for folder in FOLDERS() %%
    <fileGrp ID="FileGrp_{{ folder.name }}">
      %% for file in folder.rfiles() %%
	  %% if file.parent_object.basename != "attachments" and file.parent_object.parent_object.basename != "eaxs" %%
      <file SIZE="{{ file.size }}" ID="_{{ folder.name }}_{{ file.index }}" MIMETYPE="{{ file.mimetype() }}" CREATED="{{ file.created }}" CHECKSUM="{{ file.checksum() }}" CHECKSUMTYPE="{{ file.checksum_algorithm }}">
        <FLocat xlink:href="{{ file.name }}" LOCTYPE="OTHER" OTHERLOCTYPE="SYSTEM" />
      </file>
	  %% else %%
	    %% if skipped.append(1) %%
		%% endif %%
	  %% endif %%
      %% endfor %%
    </fileGrp>
    %% endfor %%
  </fileSec>
  %% if skipped|length > 0 %%
  <!-- Skipped {{ skipped|length }} EAXS attachment files. -->
  %% endif %%
  <structMap>
    <div>
      <div ID="Div_">
      %% for file in FILES() %%
	  	%% if ".mets.manifest" not in file.basename %%
        <fptr FILEID="_{{ file.index }}"/>
		%% endif %%
      %% endfor %%
      </div>
      %% for folder in FOLDERS() %%
      <div ID="Div_{{ folder.name }}">
        %% for file in folder.rfiles() %%
	    %% if file.parent_object.basename != "attachments" and file.parent_object.parent_object.basename != "eaxs" %%
        <fptr FILEID="_{{ folder.name }}_{{ file.index }}"/>
        %% endif %%
        %% endfor %%
      </div>
      %% endfor %%
    </div>
  </structMap>
</mets>
